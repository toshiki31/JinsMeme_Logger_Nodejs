<!doctype html
<html>
<head>
<meta charset="utf-8">
<title>Node.jsでシリアル通信</title>
<script src="/socket.io/socket.io.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<style>
 body {
  padding-top: 500px;
  background: #000;
  text-align: center;
 }
 button {
  padding: 20px 40px;
  border-bottom: #999 solid 20px;
  border-radius: 15px;
  background: #EEE;
  font-size: 100px;
 }
  button.on {
  margin-top: 15px;
  border-bottom: #095E13 solid 5px;
  background: #3C9053;
  color: #FFF;
 }
</style>
</head>
<body>
<button id="ledBtn">LED点灯</button>
<script type="text/javascript">
 var SWITCH_CLASS = "on",
 socket = io(),
 $ledBtn = $("#ledBtn"),
 ledSwitch = 0;
 
 var init = function(){
  setBrowser();
  setMicom();
 }
 
 //ブラウザ設定
 var setBrowser = function(){
  $ledBtn.on("click", function(){
   if(ledSwitch === 0){
    ledSwitch = 1; //true
    $(this).addClass(SWITCH_CLASS);
   }else{
    ledSwitch = 0; //false
    $(this).removeClass(SWITCH_CLASS);
   }
   socket.emit('led', 'l=' + ledSwitch);
  });
 },
 
 //マイコン設定
 setMicom = function(){
  socket.on("buttonSwitch", function(buttonSwitch){
   if(buttonSwitch === true){
    ledSwitch = 1;
    $ledBtn.addClass(SWITCH_CLASS);
   }else{
    ledSwitch = 0;
    $ledBtn.removeClass(SWITCH_CLASS);
   }
  });
  socket.on('recvmsg',function(data){
   $ledBtn.text(data);
  });
 };
 
 init();
 
</script>
</body>
</html>